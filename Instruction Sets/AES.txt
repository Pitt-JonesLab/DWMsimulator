CPIM $97 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF STORE 512 0
CPIM $98 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF STORE 512 0
CPIM $99 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF STORE 512 0

# Store word and rotated word
CPIM $12 0x5468617473206D79204B756E67204675 STORE 512 0
CPIM $32 0x54776F204F6E65204E696E652054776F STORE 512 0
CPIM $128 $32 COPY 512 0
CPIM $132 $12 COPY 512 0
CPIM $32 $128 XOR 512 0

CPIM $96 $12 COPY 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $100 0x000000FF000000000000000000000000 STORE 512 0
CPIM $128 $96 AND 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $100 0xFFFFFF00000000000000000000000000 STORE 512 0
CPIM $132 $96 AND 512 0
CPIM $12 $128 OR 512 1

# SubByte on Rotated word
SubByte $12 $12 8 0

# Add round constant and XOR
CPIM $12 0x01000000000000000000000000000000 STORE 512  1
CPIM $17 $12 XOR 512 2

# Shift and build last three words of roundkey 
CPIM $96 $17 COPY 512 0
CPIM $100 0xFFFFFFFF000000000000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $13 XOR 512 0 
CPIM $96 $17 COPY 512 0
CPIM $100 0x00000000FFFFFFFF0000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $13 XOR 512 0
CPIM $96 $17 COPY 512 0
CPIM $100 0x0000000000000000FFFFFFFF00000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $13 $13 XOR 512 0
CPIM $96 $13 COPY 512 0
CPIM $100 0x000000000000000000000000FFFFFFFF STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $160 0x00000000000000000000000000000000 STORE 512 1
CPIM $17 $160 OR 512 0
CPIM $17 0x00000000000000000000000000000000 STORE 512 2
CPIM $12 $16 COPY 512 0
CPIM $16 0x00000000000000000000000000000000 STORE 512 0

SubByte $32 $32 32 0

CPIM $96 $32 COPY 512 0
CPIM $100 0xFF000000FF000000FF000000FF000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $64 $32 COPY 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0x00FF000000FF000000FF000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $68 $32 COPY 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $96 $68 COPY 512 0
CPIM $100 0x00000000000000FF000000FF000000FF STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0x0000FF000000FF000000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $96 $68 COPY 512 0
CPIM $100 0x00000000000000000000FF000000FF00 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $160 $160 OR 512 1
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $64 $64 SHL8 512 0
CPIM $96 $64 SHL8 512 0
CPIM $100 0x000000FF000000000000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $68 $68 SHR8 512 0
CPIM $96 $68 SHR8 512 0
CPIM $100 0x00000000000000000000000000FF0000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $160 0x0 STORE 512 1
CPIM $160 0x0 STORE 512 1
CPIM $32 $160 OR 512 0

CPIM $192 $32 COPY 512 1
CPIM $64 $32 SHR8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0x00FFFFFF00FFFFFF00FFFFFF00FFFFFF STORE 512 0
CPIM $192 $96 AND 512 1
CPIM $64 $64 SHR8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0x0000FFFF0000FFFF0000FFFF0000FFFF STORE 512 0
CPIM $192 $96 AND 512 1
CPIM $64 $64 SHR8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0x000000FF000000FF000000FF000000FF STORE 512 0
CPIM $192 $96 AND 512 1

CPIM $128 $192 COPY 512 0
CPIM $192 0x0 STORE 512 1
CPIM $192 $192 XOR 512 1
CPIM $224 $32 COPY 512 0
CPIM $64 $32 SHL8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0xFFFFFF00FFFFFF00FFFFFF00FFFFFF00 STORE 512 0
CPIM $192 $96 AND 512 1

CPIM $132 $192 COPY 512 0
CPIM $228 $128 OR 512 0
CPIM $224 $224 XOR 512 0
CPIM $64 $64 SHL8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0xFFFF0000FFFF0000FFFF0000FFFF0000 STORE 512 0
CPIM $192 $96 AND 512 1
CPIM $64 $64 SHL8 512 0
CPIM $96 $64 COPY 512 0
CPIM $100 0xFF000000FF000000FF000000FF000000 STORE 512 0
CPIM $192 $96 AND 512 1

CPIM $128 $192 COPY 512 0
CPIM $192 0x0 STORE 512 1
CPIM $192 $192 XOR 512 1
CPIM $192 $32 COPY 512 1
CPIM $96 $224 SHL1 512 0
CPIM $100 0xFEFEFEFEFEFEFEFEFEFEFEFEFEFEFEFE STORE 512 0
CPIM $192 $96 AND 512 1

CPIM $96 $224 COPY 512 0
CPIM $100 0x80808080808080808080808080808080 STORE 512 0
CPIM $224 $96 AND 512 1
CPIM $224 $224 SHR1 512 0
CPIM $224 $224 SHR1 512 0
CPIM $224 $224 SHR1 512 0
CPIM $224 $224 SHR1 512 1
CPIM $224 $224 SHR1 512 1
CPIM $224 $224 SHR1 512 0
CPIM $224 $224 SHR1 512 1
CPIM $224 0x0 STORE 512 1
CPIM $192 $224 OR 512 1
CPIM $192 0x0 STORE 512 1
CPIM $32 $192 XOR 512 0

CPIM $128 $32 COPY 512 0
CPIM $132 $12 COPY 512 0
CPIM $32 $128 XOR 512 0


