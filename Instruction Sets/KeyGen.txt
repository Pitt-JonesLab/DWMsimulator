#Store word and rotated word
CPIM $12 0xA24B791CEF61D7AAB5E389A1D2F67E50 STORE 512 0
CPIM $96 $12 COPY 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $96 $96 SHL8 512 0
CPIM $100 0x00FFFFFF000000000000000000000000 STORE 512 0
CPIM $128 $96 AND 512 0
CPIM $96 $96 SHL 32 0
CPIM $100 0xFF000000000000000000000000000000 STORE 512 0
CPIM $132 $96 AND 512 0
CPIM $12 $128 OR 512 1

# SubByte on Rotated word
CPIM $32 $12 COPY 512 0
CPIM $192 $12 COPY 512 0
CPIM $68 $12 SHR8 512 0
CPIM $100 0xFEFEFEFE000000000000000000000000 STORE 512 0
CPIM $64 $12 SHL1 512 0
CPIM $96 $64 COPY 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0x01010101000000000000000000000000 STORE 512 0
CPIM $68 $68 SHL1 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0xFCFCFCFC000000000000000000000000 STORE 512 0
CPIM $64 $64 SHL1 512 0
CPIM $96 $64 COPY 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0x03030303000000000000000000000000 STORE 512 0
CPIM $68 $68 SHL1 512 0
CPIM $192 $96 AND 512 1
CPIM $192 $192 XOR 512 1
CPIM $100 0xF8F8F8F8000000000000000000000000 STORE 512 0
CPIM $64 $64 SHL1 512 0
CPIM $96 $64 COPY 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0x07070707000000000000000000000000 STORE 512 0
CPIM $68 $68 SHL1 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0xF0F0F0F0000000000000000000000000 STORE 512 0
CPIM $96 $64 SHL1 512 0
CPIM $192 $96 AND 512 1
CPIM $100 0x0F0F0F0F000000000000000000000000 STORE 512 0
CPIM $96 $68 SHL1 512 0
CPIM $192 $96 AND 512 1
CPIM $128 $192 XOR 512 0
CPIM $132 0x63636363000000000000000000000000 STORE 512 0
CPIM $12 $128 XOR 512 0

#Add round constant and XOR
CPIM $12 0x01000000000000000000000000000000 STORE 512  1
CPIM $17 $12 XOR 512 2

#Shift and build last three words of roundkey 
CPIM $96 $17 COPY 512 0
CPIM $100 0xFFFFFFFF000000000000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $13 XOR 512 0 
CPIM $96 $17 COPY 512 0
CPIM $100 0x00000000FFFFFFFF0000000000000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $13 XOR 512 0
CPIM $96 $17 COPY 512 0
CPIM $100 0x0000000000000000FFFFFFFF00000000 STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $17 $160 COPY 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $17 $17 SHR8 512 0
CPIM $13 $13 XOR 512 0
CPIM $96 $17 COPY 512 0
CPIM $100 0x000000000000000000000000FFFFFFFF STORE 512 0
CPIM $160 $96 AND 512 1
CPIM $160 0x00000000000000000000000000000000 STORE 512 1
CPIM $17 $160 OR 512 0
CPIM $17 0x00000000000000000000000000000000 STORE 512 2
CPIM $12 $16 COPY 512 0
CPIM $16 0x00000000000000000000000000000000 STORE 512 0
 

